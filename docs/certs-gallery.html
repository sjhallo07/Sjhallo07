<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Galería de Certificados — sjhallo07</title>
    <link rel="stylesheet" href="./assets/styles.css">
    <style>
        .gallery-wrap {
            max-width: 1100px;
            margin: 1.5rem auto
        }

        .slider {
            overflow: hidden
        }

        .slides {
            display: flex;
            gap: 1rem;
            transition: transform .35s ease
        }

        .slide {
            flex: 0 0 calc(100%/1 - 1rem);
        }

        @media(min-width:680px) {
            .slide {
                flex: 0 0 calc(50% - 1rem);
            }
        }

        @media(min-width:1100px) {
            .slide {
                flex: 0 0 calc(33.333% - 1rem);
            }
        }

        .media {
            background: #fff;
            padding: 8px;
            border-radius: 8px
        }

        .media img,
        .media object {
            width: 100%;
            height: 320px;
            object-fit: contain;
            border-radius: 6px
        }

        .controls {
            display: flex;
            gap: .5rem;
            justify-content: center;
            margin: 1rem 0
        }
    </style>
</head>

<body>
    <main class="gallery-wrap">
        <header style="display:flex;align-items:center;gap:1rem;margin-bottom:1rem">
            <img src="./assets/logo.svg" alt="logo" style="height:48px">
            <h1 style="margin:0">Galería de Certificados</h1>
        </header>

        <div class="controls">
            <button id="prev" class="btn btn-ghost">◀ Anterior</button>
            <button id="next" class="btn btn-ghost">Siguiente ▶</button>
        </div>

        <div class="slider">
            <div id="slides" class="slides"></div>
        </div>

        <div style="margin-top:1rem; text-align:center">
            <a class="btn btn-ghost" href="./certifications.html">Volver a lista</a>
        </div>
    </main>

    <script>
        function getQueryParam(name) { const url = new URL(location.href); return url.searchParams.get(name) }
        (async function () {
            const res = await fetch('./certs/metadata.json');
            const data = await res.json();
            const slides = document.getElementById('slides');
            data.forEach(c => {
                const el = document.createElement('article');
                el.className = 'slide';
                let mediaHtml = '';
                if (c.large) {
                    mediaHtml = `<img src="${c.large}" alt="${c.title}"/>`;
                } else if (c.image && (c.image.endsWith('.svg') || c.image.endsWith('.png') || c.image.endsWith('.jpg') || c.image.endsWith('.jpeg'))) {
                    mediaHtml = `<img src="${c.image}" alt="${c.title}"/>`;
                } else {
                    mediaHtml = `<object data="${c.pdf}" type="application/pdf" aria-label="${c.title}"><a href="${c.pdf}" target="_blank">Abrir PDF</a></object>`;
                }
                el.innerHTML = `
          <div class="card media">
            <h3 style="margin:0 0 .5rem 0">${c.title}</h3>
            ${mediaHtml}
            <p class="muted" style="margin-top:.5rem">${c.description}</p>
            <div style="margin-top:.5rem;display:flex;gap:.5rem">
              <a class="btn btn-primary" href="${c.pdf}" target="_blank">Abrir</a>
              <a class="btn btn-ghost" href="${c.verify_url}" target="_blank">Verificación</a>
            </div>
          </div>
        `;
                slides.appendChild(el);
            });

            const perView = () => {
                const w = window.innerWidth;
                if (w >= 1100) return 3;
                if (w >= 680) return 2;
                return 1;
            }

            let index = 0;
            const update = () => {
                const pv = perView();
                const offset = index * (100 / pv);
                slides.style.transform = `translateX(-${offset}%)`;
            }

            document.getElementById('prev').addEventListener('click', () => { index = Math.max(0, index - 1); update(); });
            document.getElementById('next').addEventListener('click', () => { index = Math.min(data.length - 1, index + 1); update(); });

            // focus on specific certificate if provided
            const focus = getQueryParam('focus');
            if (focus) {
                const i = data.findIndex(d => d.id === focus);
                if (i >= 0) { index = i; update(); }
            }

            window.addEventListener('resize', update);
            update();
        })();
    </script>
</body>

</html>